<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xtlcon="http://www.xtpxlib.nl/ns/container"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="keywords" content="xproc xprocref xml step p:www-form-urldecode www-form-urldecode"><link href="../css/bootstrap.min.css" rel="stylesheet"><link href="../css/xprocref.css" rel="stylesheet"><script defer src="../js/bootstrap.bundle.min.js"></script><title>&nbsp;p:www-form-urldecode (3.1)&nbsp;</title><link rel="shortcut icon" href="../images/favicon.ico"></head><body><nav class="navbar navbar-expand-sm bg-secondary navbar-dark "><div class="container-fluid"><a class="navbar-brand" href="../index.html"><img src="../images/logo.png" class="img-fluid" width="18%"></a></div><div class="container-fluid"><ul class="nav justify-content-end nav-pills text-light"><li class="nav-item lead"><a class="nav-link text-light" href="../index.html">home</a></li><li class="nav-item lead"><a class="nav-link text-light" href="../3.0/categories.html">categories</a></li><li class="nav-item dropdown lead"><a class="nav-link dropdown-toggle text-light" data-bs-toggle="dropdown" href="#">info</a><ul class="dropdown-menu"><li class="lead"><a class="dropdown-item" href="../versions.html">versions</a></li><li class="lead"><a class="dropdown-item" href="../error-codes.html">error codes</a></li><li class="lead"><a class="dropdown-item" href="../namespaces.html">namespaces</a></li><li class="lead"><a class="dropdown-item" href="https://xproc.org">XProc</a></li></ul></li><li class="nav-item lead"><a class="nav-link text-light" href="../about.html">about</a></li></ul></div></nav><div class="container pt-5"><div class="sect1" id="sect1-d574e70862"><a name="sect1-d574e70862"><!----></a><h1 class="sect1"><a href="p.wrap-sequence.html"><span class="link"><img src="../images/previous.png" class="inlinemediaobject next-prev-marker" width="1.5%"></span></a>&nbsp;p:www-form-urldecode (3.1)&nbsp;<a href="p.www-form-urlencode.html"><span class="link"><img src="../images/next.png" class="inlinemediaobject next-prev-marker" width="1.5%"></span></a></h1><p class="para">Decode a URL parameter string into a map.</p><ul class="itemizedlist toc toc-2"><li><p class="para tocentry tocentry-2"><a href="#sect2-d574e70875"><span class="link">Summary</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d574e70976"><span class="link">Description</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d574e71020"><span class="link">Examples</span></a></p><ul class="itemizedlist toc toc-3"><li><p class="para tocentry tocentry-3"><a href="#sect3-d574e71023"><span class="link">Basic usage</span></a></p></li><li><p class="para tocentry tocentry-3"><a href="#p_www-form-urldecode-v31-parsamename"><span class="link">Parameters with the same name</span></a></p></li></ul></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d574e71086"><span class="link">Additional details</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d574e71110"><span class="link">Errors raised</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d574e71140"><span class="link">Reference information</span></a></p></li></ul><div class="sect2" id="sect2-d574e70875"><a name="sect2-d574e70875"><!----></a><h2 class="sect2">Summary</h2><div class="programlisting step-signature"><pre class="programlisting step-signature">&lt;p:declare-step type="p:www-form-urldecode"&gt;
  &lt;output port="result" primary="true" content-types="application/json" sequence="true"/&gt;
  &lt;option name="value" as="xs:string" required="true"/&gt;
&lt;/p:declare-step&gt;</pre></div><p class="para">The <code class="code step">p:www-form-urldecode</code> step decodes a URL parameter string (like <code class="code">a=b&amp;c=d</code>) into a map. The result appears on the <code class="code port">result</code>
      port as a JSON document.</p><p class="para table-header">Ports:</p><div class="table nonumber ports-table"><table class="table nonumber ports-table"><thead><tr><th><p class="para">Port</p></th><th><p class="para">Type</p></th><th><p class="para">Primary?</p></th><th><p class="para">Content types</p></th><th><p class="para">Seq?</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para"><code class="code">result</code></p></td><td><p class="para"><code class="code">output</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para"><code class="code">application/json</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para">The resulting map, as a JSON document.</p></td></tr></tbody></table></div><p class="para table-header">Options:</p><div class="table nonumber options-table"><table class="table nonumber options-table"><thead><tr><th><p class="para">Name</p></th><th><p class="para">Type</p></th><th><p class="para">Req?</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para"><code class="code">value</code></p></td><td><p class="para"><code class="code">xs:string</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para">The URL parameter string to decode.</p></td></tr></tbody></table></div></div><div class="sect2" id="sect2-d574e70976"><a name="sect2-d574e70976"><!----></a><h2 class="sect2">Description</h2><p class="para">The <code class="code step">p:www-form-urldecode</code> step is one of the few steps that have no primary input port, its main input is the value of the <code class="code option">value</code> option.
      This value must be a valid URL parameter string: the part that usually comes after the <code class="code">?</code> in a URL, like <code class="code">a=b&amp;c=d</code>.
      Officially, this is called a <code class="code">x-www-form-urlencoded</code> string. This format is also used for sending HTML form data over HTTP.</p><p class="para">The <code class="code step">p:www-form-urldecode</code> step takes such a string in its <code class="code option">value</code> option and converts it into a map. Each name/value pair in the input
      string is represented as a key/value pair in the map. Percent encoded values (like <code class="code">%20</code> for space) are decoded. The <code class="code">+</code>
      sign also acts as a space.</p><p class="para">The resulting map appears on the <code class="code port">result</code> port as a JSON document.</p><p class="para">There is also a step for <span class="emphasis italic">encoding</span> these kinds of strings, called <code class="code step"><a href="p.www-form-urlencode.html"><span class="link">p:www-form-urlencode</span></a></code>.</p></div><div class="sect2" id="sect2-d574e71020"><a name="sect2-d574e71020"><!----></a><h2 class="sect2">Examples</h2><div class="sect3" id="sect3-d574e71023"><a name="sect3-d574e71023"><!----></a><h3 class="sect3">Basic usage</h3><p class="para keep-with-next">Pipeline document:</p><div class="programlisting"><pre class="programlisting">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt;

  &lt;p:output port="result"/&gt;

  &lt;p:www-form-urldecode value="a=b&amp;amp;b=a%20b&amp;amp;c=d+e+f"/&gt;

&lt;/p:declare-step&gt;</pre></div><p class="para keep-with-next">Result document:</p><div class="programlisting"><pre class="programlisting">{"a":"b","b":"a b","c":"d e f"}</pre></div><p class="para">Now assume youâ€™re interested in parameter <code class="code">c</code> and want to turn its value into an XML element. This is how you can do
      this:</p><div class="programlisting"><pre class="programlisting">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt;

  &lt;p:output port="result"/&gt;

  &lt;p:www-form-urldecode value="a=b&amp;amp;b=a%20b&amp;amp;c=d+e+f"/&gt;
  &lt;p:identity&gt;
    &lt;p:with-input&gt;
      &lt;result-c&gt;{.?c}&lt;/result-c&gt;
    &lt;/p:with-input&gt;
  &lt;/p:identity&gt;

&lt;/p:declare-step&gt;</pre></div><p class="para keep-with-next">Result document:</p><div class="programlisting"><pre class="programlisting">&lt;result-c&gt;d e f&lt;/result-c&gt;</pre></div><p class="para">The document coming out of the <code class="code step">p:www-form-urldecode</code> step is a map. This map flows through my pipeline. The <code class="code step"><a href="p.identity.html"><span class="link">p:identity</span></a></code> step, since it
      directly follows <code class="code step">p:www-form-urldecode</code>, can address this map with the dot <code class="code">.</code> operator. And <code class="code">.?c</code> is syntactic sugar for: give me the
      value of the context item map with the key <code class="code">'c'</code>. You could also have written it as <code class="code">.('c')</code>.</p></div><div class="sect3" id="p_www-form-urldecode-v31-parsamename"><a name="p_www-form-urldecode-v31-parsamename"><!----></a><h3 class="sect3">Parameters with the same name</h3><p class="para">When the string to decode contains multiple parameters with the same name, the result for that key will be a <span class="emphasis italic">sequence</span>
      of values. We cannot serialize such a result directly (since JSON doesn't allow map entries with multiple values), but we can access and work
      with it in our program.</p><p class="para">In the following example, parameter <code class="code">a</code> is duplicated. The <code class="code step"><a href="p.identity.html"><span class="link">p:identity</span></a></code> step combines the values for
        <code class="code">a</code> with a pipe character <code class="code">|</code>, using the XPath <code class="code"><a href="https://www.w3.org/TR/xpath-functions-31/#func-string-join" target="_blank"><span class="link newpage">string-join()</span></a></code> function.</p><div class="programlisting"><pre class="programlisting">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt;

  &lt;p:output port="result"/&gt;

  &lt;p:www-form-urldecode value="a=b&amp;amp;b=a%20b&amp;amp;a=d+e+f"/&gt;
  &lt;p:identity&gt;
    &lt;p:with-input&gt;
      &lt;result-a-sequence&gt;{string-join(.?a, '|')}&lt;/result-a-sequence&gt;
    &lt;/p:with-input&gt;
  &lt;/p:identity&gt;

&lt;/p:declare-step&gt;</pre></div><p class="para keep-with-next">Result document:</p><div class="programlisting"><pre class="programlisting">&lt;result-a-sequence&gt;b|d e f&lt;/result-a-sequence&gt;</pre></div></div></div><div class="sect2" id="sect2-d574e71086"><a name="sect2-d574e71086"><!----></a><h2 class="sect2">Additional details</h2><ul class="itemizedlist"><li><p class="para">The document appearing on the <code class="code port">result</code> port only has a <code class="code property">content-type</code> property. It has no other
    document-properties (also no <code class="code property">base-uri</code>).</p></li><li><p class="para">If any parameter name occurs more than once in the input string, a sequence will be associated with the respective key. The order in the
      sequence retains the order of name/value pairs in the encoded string. However, if this happens, you cannot serialize (write to, for instance,
      disk) the result because it is no longer valid JSON. You can however still use the map in your program and access its members. See also the
        <a href="#p_www-form-urldecode-v31-parsamename"><span class="link">Parameters with the same name</span></a> example</p></li></ul></div><div class="sect2" id="sect2-d574e71110"><a name="sect2-d574e71110"><!----></a><h2 class="sect2">Errors raised</h2><div class="table nonumber error-codes-table"><table class="table nonumber error-codes-table"><thead><tr><th><p class="para">Error code</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para" id="error-XC0037"><a name="error-XC0037"><!----></a><a href="../error-codes.html#error-XC0037"><span class="link"><code class="code">XC0037</code></span></a></p></td><td><p class="para">It is a dynamic error if the <code class="code option">value</code> provided is not a properly <code class="literal">x-www-form-urlencoded</code> value.</p></td></tr></tbody></table></div></div><div class="sect2" id="sect2-d574e71140"><a name="sect2-d574e71140"><!----></a><h2 class="sect2">Reference information</h2><p class="para">This description of the <code class="code step">p:www-form-urldecode</code> step is for XProc version: <a href="index.html"><span class="link">3.1</span></a>. This is a required step (an XProc 3.1 processor must support this).</p><p class="para">The formal specification for the <code class="code step">p:www-form-urldecode</code> step can be found <a href="https://spec.xproc.org/lastcall-2024-08/head/steps/#c.www-form-urldecode" target="_blank"><span class="link newpage">here</span></a>.</p><p class="para">The <code class="code step">p:www-form-urldecode</code> step is part of categories:</p><ul class="itemizedlist"><li><p class="para"><a href="Standard_XProc_steps.html"><span class="link">Standard XProc steps</span></a></p></li><li><p class="para"><a href="Interaction_with_the_environment.html"><span class="link">Interaction with the environment</span></a></p></li></ul><p class="para">The <code class="code step">p:www-form-urldecode</code> step is also present in version:
                <a href="../3.0/p.www-form-urldecode.html"><span class="link">3.0</span></a>.</p></div></div></div><p>&nbsp;</p></body></html>