<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xtlcon="http://www.xtpxlib.nl/ns/container"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="keywords" content="xproc xprocref xml step p:file-create-tempfile file-create-tempfile file temporary temp"><link href="../css/bootstrap.min.css" rel="stylesheet"><link href="../css/xprocref.css" rel="stylesheet"><script defer src="../js/bootstrap.bundle.min.js"></script><title>&nbsp;p:file-create-tempfile (3.1)&nbsp;</title><link rel="shortcut icon" href="../images/favicon.ico"></head><body><nav class="navbar navbar-expand-sm bg-secondary navbar-dark "><div class="container-fluid"><a class="navbar-brand" href="../index.html"><img src="../images/logo.png" class="img-fluid" width="18%"></a></div><div class="container-fluid"><ul class="nav justify-content-end nav-pills text-light"><li class="nav-item lead"><a class="nav-link text-light" href="../index.html">home</a></li><li class="nav-item lead"><a class="nav-link text-light" href="../3.1/categories.html">categories</a></li><li class="nav-item dropdown lead"><a class="nav-link dropdown-toggle text-light" data-bs-toggle="dropdown" href="#">info</a><ul class="dropdown-menu"><li class="lead"><a class="dropdown-item" href="../versions.html">Versions</a></li><li class="lead"><a class="dropdown-item" href="../error-codes.html">Error codes</a></li><li class="lead"><a class="dropdown-item" href="../namespaces.html">Namespaces</a></li><li class="lead"><a class="dropdown-item" href="https://xproc.org">XProc</a></li><li class="lead"><a class="dropdown-item" href="https://github.com/xatapult/xprocref">Site GitHub</a></li><li class="lead"><a class="dropdown-item" href="https://github.com/xatapult/xprocref/issues">Site issues</a></li></ul></li><li class="nav-item lead"><a class="nav-link text-light" href="../about.html">about</a></li></ul></div></nav><div class="container pt-5"><div class="sect1" id="sect1-d626e13845"><a name="sect1-d626e13845"><!----></a><h1 class="sect1"><a href="p.file-copy.html"><span class="link"><img src="../images/previous.png" class="inlinemediaobject next-prev-marker" width="1.5%"></span></a>&nbsp;p:file-create-tempfile (3.1)&nbsp;<a href="p.file-delete.html"><span class="link"><img src="../images/next.png" class="inlinemediaobject next-prev-marker" width="1.5%"></span></a></h1><p class="para keep-with-next">Creates a temporary file.</p><ul class="itemizedlist toc toc-2"><li><p class="para tocentry tocentry-2"><a href="#sect2-d626e13858"><span class="link">Summary</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d626e14097"><span class="link">Description</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d626e14164"><span class="link">Examples</span></a></p><ul class="itemizedlist toc toc-3"><li><p class="para tocentry tocentry-3"><a href="#sect3-d626e14167"><span class="link">Basic usage</span></a></p></li><li><p class="para tocentry tocentry-3"><a href="#p_file-create-tempfile-v31-set-extension"><span class="link">Specifying the temporary file’s extension</span></a></p></li><li><p class="para tocentry tocentry-3"><a href="#sect3-d626e14191"><span class="link">Using a temporary file</span></a></p></li></ul></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d626e14206"><span class="link">Additional details</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d626e14242"><span class="link">Errors raised</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d626e14314"><span class="link">Reference information</span></a></p></li></ul><div class="sect2" id="sect2-d626e13858"><a name="sect2-d626e13858"><!----></a><h2 class="sect2">Summary</h2><div class="programlisting step-signature"><pre class="programlisting step-signature">&lt;p:declare-step type="p:file-create-tempfile"&gt;
  &lt;output port="result" primary="true" content-types="application/xml" sequence="false"/&gt;
  &lt;option name="delete-on-exit" as="xs:boolean" required="false" select="false()"/&gt;
  &lt;option name="fail-on-error" as="xs:boolean" required="false" select="true()"/&gt;
  &lt;option name="href" as="xs:anyURI?" required="false" select="()"/&gt;
  &lt;option name="prefix" as="xs:string?" required="false" select="()"/&gt;
  &lt;option name="suffix" as="xs:string?" required="false" select="()"/&gt;
&lt;/p:declare-step&gt;</pre></div><p class="para">The <code class="code step">p:file-create-tempfile</code> step creates a temporary file.</p><p class="para table-header keep-with-next">Ports:</p><div class="table nonumber ports-table"><table class="table nonumber ports-table"><thead><tr><th><p class="para">Port</p></th><th><p class="para">Type</p></th><th><p class="para">Primary?</p></th><th><p class="para">Content types</p></th><th><p class="para">Seq?</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para"><code class="code">result</code></p></td><td><p class="para"><code class="code">output</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para"><code class="code">application/xml</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para">A <code class="tag">&lt;c:result&gt;</code> element containing the absolute URI of the created temporary file (the <code class="code">c</code> prefix here is bound to the
            <code class="code">http://www.w3.org/ns/xproc-step</code> namespace).</p></td></tr></tbody></table></div><p class="para table-header keep-with-next">Options:</p><div class="table nonumber options-table"><table class="table nonumber options-table"><thead><tr><th><p class="para">Name</p></th><th><p class="para">Type</p></th><th><p class="para">Req?</p></th><th><p class="para">Default</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para"><code class="code">delete-on-exit</code></p></td><td><p class="para"><code class="code">xs:boolean</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para">If set to <code class="code">true</code>, an attempt will be made to automatically delete the temporary file when the processor terminates the
          pipeline. No error will be raised if this is unsuccessful.</p></td></tr><tr><td><p class="para"><code class="code">fail-on-error</code></p></td><td><p class="para"><code class="code">xs:boolean</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para">Determines what happens if an error occurs during the operation:</p><ul class="itemizedlist"><li><p class="para">If this option is <code class="code">true</code> (default), an appropriate XProc error is raised.</p></li><li><p class="para">If this option is <code class="code">false</code>, the step returns a <code class="tag">&lt;c:error&gt;</code> document (see <a href="https://spec.xproc.org/master/head/xproc/#err-vocab" target="_blank"><span class="link newpage">here</span></a> for more information) on its <code class="code port">result</code>
        port.</p></li></ul></td></tr><tr><td><p class="para"><code class="code">href</code></p></td><td><p class="para"><code class="code">xs:anyURI?</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">()</code></p></td><td><p class="para">The URI of the (existing) directory where the temporary file is created. If not specified, location of the temporary file is
          implementation-defined and therefore depends on the XProc processor used. Usually this will be the operating system’s default
          location for temporary files.</p></td></tr><tr><td><p class="para"><code class="code">prefix</code></p></td><td><p class="para"><code class="code">xs:string?</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">()</code></p></td><td><p class="para">The prefix string for the name of the temporary file to create.</p><p class="para">Specifying a prefix is useful if your want the temporary files created by your pipeline to be distinguishable from other temporary files
          in the same directory.</p></td></tr><tr><td><p class="para"><code class="code">suffix</code></p></td><td><p class="para"><code class="code">xs:string?</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">()</code></p></td><td><p class="para">The suffix string for the name of the temporary file to create.</p><p class="para">Setting the <code class="code option">suffix</code> option must be used if you want your temporary file to have a specific extension, like
            <code class="code">.xml</code>. See also the <a href="#p_file-create-tempfile-v31-set-extension"><span class="link">Specifying the temporary file’s extension</span></a> example.</p></td></tr></tbody></table></div></div><div class="sect2" id="sect2-d626e14097"><a name="sect2-d626e14097"><!----></a><h2 class="sect2">Description</h2><p class="para">XProc is designed to process documents without having to continuously store and load these documents to/from disk. But sometimes you do need
      documents to be stored on disk, for instance when some additional process demands this. You can of course solve this by using <a href="p.store.html"><span class="link"><code class="code step">p:store</code></span></a> with a fixed (or generated) filename. However, if the filename is not important, or there is no obvious location for these
      files, or if you do’t want these documents to survive pipeline processing, <code class="code step">p:file-create-tempfile</code> comes to the rescue.</p><p class="para">The <code class="code step">p:file-create-tempfile</code> step creates a temporary file:</p><ul class="itemizedlist"><li><p class="para">It is guaranteed that this file didn’t exist beforehand.</p></li><li><p class="para">The directory where the will be created can be specified using the <code class="code option">href</code> option (if you don’t, some logical,
          system dependent, location for temporary files will be used).</p></li><li><p class="para">The main part of the filename will be generated by the step. However, you can specify a filename suffix (in the <code class="code option">suffix</code>
          option) and prefix (in the <code class="code option">prefix</code> option). This is especially useful if you want your temporary file to have a specific
          extension. See also the <a href="#p_file-create-tempfile-v31-set-extension"><span class="link">Specifying the temporary file’s extension</span></a> example.</p></li><li><p class="para">If you want the resulting temporary file to get deleted after the pipeline finishes, set the <code class="code option">delete-on-exit</code> option to
          true. There is however no guarantee that this deletion succeeds (and you will not get notified if it does’t).</p></li></ul><p class="para"> The <code class="code port">result</code> port emits a small XML document with only a <code class="tag">&lt;c:result&gt;</code> element, containing the absolute URI of the
      temporary file (the <code class="code">c</code> prefix here is bound to the <code class="code">http://www.w3.org/ns/xproc-step</code> namespace).</p></div><div class="sect2" id="sect2-d626e14164"><a name="sect2-d626e14164"><!----></a><h2 class="sect2">Examples</h2><div class="sect3" id="sect3-d626e14167"><a name="sect3-d626e14167"><!----></a><h3 class="sect3">Basic usage</h3><p class="para">The following example creates a temporary file in the (existing) <code class="code">build/</code> subdirectory (and deletes this again when the pipeline
      has come to an end):</p><p class="para keep-with-next">Pipeline document:</p><div class="programlisting"><pre class="programlisting">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt;

  &lt;p:output port="result"/&gt;
  
  &lt;p:file-create-tempfile href="build/" delete-on-exit="true"/&gt;

&lt;/p:declare-step&gt;</pre></div><p class="para keep-with-next">Result document:</p><div class="programlisting"><pre class="programlisting">&lt;c:result xmlns:c="http://www.w3.org/ns/xproc-step"&gt;file:/…/…/build/17724483791810581564.tmp&lt;/c:result&gt;</pre></div></div><div class="sect3" id="p_file-create-tempfile-v31-set-extension"><a name="p_file-create-tempfile-v31-set-extension"><!----></a><h3 class="sect3">Specifying the temporary file’s extension</h3><p class="para">The following example creates a temporary file with a specific <code class="code">.xml</code> extension in the (existing) <code class="code">build/</code>
      subdirectory. In this case we don’t specify that the file must get deleted after the pipeline finishes. Because of the explicit
        <code class="code">.xml</code> extension, it will be easy to open and inspect the file using your XML editor, if needed.</p><p class="para keep-with-next">Pipeline document:</p><div class="programlisting"><pre class="programlisting">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt;

  &lt;p:output port="result"/&gt;
  
  &lt;p:file-create-tempfile href="build/" suffix=".xml"/&gt;

&lt;/p:declare-step&gt;</pre></div><p class="para keep-with-next">Result document:</p><div class="programlisting"><pre class="programlisting">&lt;c:result xmlns:c="http://www.w3.org/ns/xproc-step"&gt;file:/…/…/build/2558030278035634051.xml&lt;/c:result&gt;</pre></div></div><div class="sect3" id="sect3-d626e14191"><a name="sect3-d626e14191"><!----></a><h3 class="sect3">Using a temporary file</h3><p class="para">Of course, just creating a temporary file is not very useful. You’ll want to write some data to it. The following example shows you
      how to do this: the document appearing on the <code class="code port">source</code> port is written to the temporary file. This is not very useful in itself but
      it shows how you can “catch” the created temporary file URI and use this in a subsequent step.</p><p class="para keep-with-next">Pipeline document:</p><div class="programlisting"><pre class="programlisting">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0" name="example-pipeline"&gt;

  &lt;p:input port="source"/&gt;
  &lt;p:output port="result"/&gt;
  
  &lt;p:file-create-tempfile href="build/" suffix=".xml"/&gt;

  &lt;p:store href="{string(.)}"&gt;
    &lt;p:with-input pipe="source@example-pipeline"/&gt;
  &lt;/p:store&gt;

&lt;/p:declare-step&gt;</pre></div><p class="para">You might also consider catching the created temporary file URI in a variable and use it from there. For this, add the next line directly
      after the <code class="code step">p:file-create-tempfile</code> invocation:</p><div class="programlisting"><pre class="programlisting">&lt;p:variable name="href-tempfile-uri" select="string(.)"/&gt;</pre></div></div></div><div class="sect2" id="sect2-d626e14206"><a name="sect2-d626e14206"><!----></a><h2 class="sect2">Additional details</h2><ul class="itemizedlist"><li><p class="para">The document appearing on the <code class="code port">result</code> port only has a <code class="code property">content-type</code> property. It has no other
    document-properties (also no <code class="code property">base-uri</code>).</p></li><li><p class="para">Relative values for the <code class="code option">href</code> option are resolved against the base URI of the element on which this option is specified. In
      most cases this will be the static base URI of your pipeline (the path where the XProc source containing the <code class="code step">p:file-create-tempfile</code> is stored).</p></li><li><p class="para">Working on “normal” files and/or directories (on disk, URI scheme <code class="code">file://</code>) is always supported. Whether any other
    types are supported is implementation-defined, and therefore depends on the XProc processor used. For this, also the interpretation/definition of
    what is a “directory” and “file” may vary.</p></li></ul></div><div class="sect2" id="sect2-d626e14242"><a name="sect2-d626e14242"><!----></a><h2 class="sect2">Errors raised</h2><div class="table nonumber error-codes-tablee"><table class="table nonumber error-codes-tablee"><thead><tr><th><p class="para">Error code</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para" id="error-XC0116"><a name="error-XC0116"><!----></a><a href="../error-codes.html#error-XC0116"><span class="link"><code class="code">XC0116</code></span></a></p></td><td><p class="para">It is a dynamic error if the temporary file could not be created.</p></td></tr><tr><td><p class="para" id="error-XC0138"><a name="error-XC0138"><!----></a><a href="../error-codes.html#error-XC0138"><span class="link"><code class="code">XC0138</code></span></a></p></td><td><p class="para">It is a dynamic error if an implementation does not support <code class="tag">&lt;p:file-create-tempfile&gt;</code> for a specified scheme.</p></td></tr><tr><td><p class="para" id="error-XC0139"><a name="error-XC0139"><!----></a><a href="../error-codes.html#error-XC0139"><span class="link"><code class="code">XC0139</code></span></a></p></td><td><p class="para">It is a dynamic error if <code class="tag">&lt;p:file-create-tempfile&gt;</code> cannot be completed due to access restrictions in the environment in which the
        pipeline is run.</p></td></tr><tr><td><p class="para" id="error-XD0011"><a name="error-XD0011"><!----></a><a href="../error-codes.html#error-XD0011"><span class="link"><code class="code">XD0011</code></span></a></p></td><td><p class="para">It is a dynamic error if the resource referenced by the <code class="code option">href</code> option does not exist, cannot be accessed or is not a
        file.</p></td></tr><tr><td><p class="para" id="error-XD0064"><a name="error-XD0064"><!----></a><a href="../error-codes.html#error-XD0064"><span class="link"><code class="code">XD0064</code></span></a></p></td><td><p class="para">It is a dynamic error if the base URI is not both absolute and valid according to <a href="https://www.rfc-editor.org/info/rfc3986" target="_blank"><span class="link newpage">RFC&nbsp;3986</span></a> .</p></td></tr></tbody></table></div></div><div class="sect2 reference-section" id="sect2-d626e14314"><a name="sect2-d626e14314"><!----></a><h2 class="sect2 reference-section">Reference information</h2><p class="para">This description of the <code class="code step">p:file-create-tempfile</code> step is for XProc version: <a href="../index.html"><span class="link">3.1</span></a>. This is a non-required step (an XProc 3.1 processor does not have to support this).</p><p class="para">The formal specification for the <code class="code step">p:file-create-tempfile</code> step can be found <a href="https://spec.xproc.org/master/head/file/#c.file-create-tempfile" target="_blank"><span class="link newpage specification-link">here</span></a>.</p><p class="para">The <code class="code step">p:file-create-tempfile</code> step is part of categories:</p><ul class="itemizedlist"><li><p class="para"><a href="XProc_file_and_directory_related_steps.html"><span class="link">XProc file and directory related steps</span></a></p></li><li><p class="para"><a href="Interaction_with_the_environment.html"><span class="link">Interaction with the environment</span></a></p></li></ul><p class="para">The <code class="code step">p:file-create-tempfile</code> step is also present in version:
                <a href="../3.0/p.file-create-tempfile.html"><span class="link">3.0</span></a>.</p></div></div></div><p>&nbsp;</p></body></html>