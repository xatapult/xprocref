<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xtlcon="http://www.xtpxlib.nl/ns/container"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="../css/bootstrap.min.css" rel="stylesheet"><link href="../css/xprocref.css" rel="stylesheet"><script defer src="../js/bootstrap.bundle.min.js"></script><title>&nbsp;p:make-absolute-uris (3.1)&nbsp;</title><link rel="shortcut icon" href="../images/favicon.ico"></head><body><nav class="navbar navbar-expand-sm bg-secondary navbar-dark "><div class="container-fluid"><a class="navbar-brand" href="../index.html"><img src="../images/logo.png" class="img-fluid" width="18%"></a></div><div class="container-fluid"><ul class="nav justify-content-end nav-pills text-light"><li class="nav-item lead"><a class="nav-link text-light" href="../index.html">home</a></li><li class="nav-item lead"><a class="nav-link text-light" href="../3.0/categories.html">categories</a></li><li class="nav-item dropdown lead"><a class="nav-link dropdown-toggle text-light" data-bs-toggle="dropdown" href="#">info</a><ul class="dropdown-menu"><li class="lead"><a class="dropdown-item" href="../versions.html">versions</a></li><li class="lead"><a class="dropdown-item" href="../error-codes.html">error codes</a></li><li class="lead"><a class="dropdown-item" href="../namespaces.html">namespaces</a></li><li class="lead"><a class="dropdown-item" href="https://xproc.org">XProc</a></li></ul></li><li class="nav-item lead"><a class="nav-link text-light" href="../about.html">about</a></li></ul></div></nav><div class="container pt-5"><p class="para page-banner">This site is work in progress and does not yet describe all available steps.</p><div class="sect1" id="sect1-d420e38241"><a name="sect1-d420e38241"><!----></a><h1 class="sect1"><a href="p.load.html"><span class="link"><img src="../images/previous.png" class="inlinemediaobject next-prev-marker" width="1.5%"></span></a>&nbsp;p:make-absolute-uris (3.1)&nbsp;<a href="p.namespace-delete.html"><span class="link"><img src="../images/next.png" class="inlinemediaobject next-prev-marker" width="1.5%"></span></a></h1><p class="para">Make URIs in the document absolute.</p><ul class="itemizedlist toc toc-2"><li><p class="para tocentry tocentry-2"><a href="#sect2-d420e38254"><span class="link">Summary</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d420e38406"><span class="link">Description</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d420e38477"><span class="link">Examples</span></a></p><ul class="itemizedlist toc toc-3"><li><p class="para tocentry tocentry-3"><a href="#p_make-absolute-uris-v31-basic-usage"><span class="link">Basic usage</span></a></p></li></ul></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d420e38513"><span class="link">Additional details</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d420e38549"><span class="link">Errors raised</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d420e38585"><span class="link">Reference information</span></a></p></li></ul><div class="sect2" id="sect2-d420e38254"><a name="sect2-d420e38254"><!----></a><h2 class="sect2">Summary</h2><div class="programlisting step-signature"><pre class="programlisting step-signature">&lt;p:declare-step type="p:make-absolute-uris"&gt;
  &lt;input port="source" primary="true" content-types="xml html" sequence="false"/&gt;
  &lt;output port="result" primary="true" content-types="xml html" sequence="false"/&gt;
  &lt;option name="match" as="xs:string" required="true"/&gt;
  &lt;option name="base-uri" as="xs:anyURI?" required="false" select="()"/&gt;
&lt;/p:declare-step&gt;</pre></div><p class="para">The <code class="code step">p:make-absolute-uris</code> step makes element and/or attribute values in the document appearing on the <code class="code port">source</code> port absolute by applying a base
      URI.</p><p class="para table-header">Ports:</p><div class="table nonumber ports-table"><table class="table nonumber ports-table"><thead><tr><th><p class="para">Type</p></th><th><p class="para">Port</p></th><th><p class="para">Primary?</p></th><th><p class="para">Content types</p></th><th><p class="para">Seq?</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para"><code class="code">input</code></p></td><td><p class="para"><code class="code">source</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para"><code class="code">xml html</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para">The document to resolve the URIs in.</p></td></tr><tr><td><p class="para"><code class="code">output</code></p></td><td><p class="para"><code class="code">result</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para"><code class="code">xml html</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para">The resulting document.</p></td></tr></tbody></table></div><p class="para table-header">Options:</p><div class="table nonumber options-table"><table class="table nonumber options-table"><thead><tr><th><p class="para">Name</p></th><th><p class="para">Type</p></th><th><p class="para">Req?</p></th><th><p class="para">Default</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para"><code class="code">match</code></p></td><td><p class="para"><code class="code">xs:string</code> (XSLT selection pattern)</p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para"><code class="code">&nbsp;</code></p></td><td><p class="para">The XSLT match pattern for the attributes and/or elements that hold the URIs to change.</p></td></tr><tr><td><p class="para"><code class="code">base-uri</code></p></td><td><p class="para"><code class="code">xs:anyURI?</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">()</code></p></td><td><p class="para">The base URI to use for making the matched attributes/elements absolute.</p><p class="para">If this option is not specified, the base URI of the matched element/attribute in the source document is used. In most cases this will
          be the location (path on disk) where it originated from.</p></td></tr></tbody></table></div></div><div class="sect2" id="sect2-d420e38406"><a name="sect2-d420e38406"><!----></a><h2 class="sect2">Description</h2><p class="para">The <code class="code step">p:make-absolute-uris</code> step takes the document appearing on its <code class="code port">source</code> port and searches for elements and/or attributes as indicated by
      the <code class="code option">match</code> option. The values of these elements/attributes are taken as URIs and, if relative, resolved against a base URI as
      specified in the <code class="code option">base-uri</code> option. If there's no <code class="code option">base-uri</code> option, the base URI of the element/attribute is
      used.</p><p class="para">Why is this useful? URIs in documents that are edited or received from the web are often relative. They point to other documents, for
      instance images, that are elsewhere on disk or the web, in a location <span class="emphasis italic">relative</span> to the source document. For instance:
        <code class="code">images/picture.jpg</code>. This allows for flexibility in the location of the documents. However, when processing these URIs and access
      the referenced documents, the code needs to know how to resolve them into absolute ones. It is practical to arrange all this URI resolving in
      advance, and this is what <code class="code step">p:make-absolute-uris</code> is for.</p><p class="para">There is an important thing to keep in mind when supplying a value for the <code class="code option">base-uri</code> option:</p><ul class="itemizedlist"><li><p class="para">When its value ends with a slash (<code class="code">/</code>), it points to a <span class="emphasis italic">location</span>. All URIs are resolved against that
          location. For instance: <code class="code">file:///myapp/images/</code></p></li><li><p class="para">When its value does <span class="emphasis italic">not</span> end with a slash, it points to a document. All URIs are resolved against the location of
          this document. For instance, for a <code class="code option">base-uri</code> value <code class="code">file:///myapp/images/logo.svg</code>, the URIs are resolved against the location
            <code class="code">file:///myapp/images/</code></p></li></ul><p class="para">The <a href="#p_make-absolute-uris-v31-basic-usage"><span class="link">Basic usage</span></a> example shows this difference.</p></div><div class="sect2" id="sect2-d420e38477"><a name="sect2-d420e38477"><!----></a><h2 class="sect2">Examples</h2><div class="sect3" id="p_make-absolute-uris-v31-basic-usage"><a name="p_make-absolute-uris-v31-basic-usage"><!----></a><h3 class="sect3">Basic usage</h3><p class="para">This example shows what happens to different kinds of URIs when resolved. The <code class="code option">base-uri</code> value here points to a
        <span class="emphasis italic">location</span> (because it ends with a <code class="code">/</code>).</p><p class="para keep-with-next">Source document:</p><div class="programlisting"><pre class="programlisting">&lt;URIs&gt;
   &lt;URI&gt;image.jpg&lt;/URI&gt;
   &lt;URI&gt;A/B/C/&lt;/URI&gt;
   &lt;URI&gt;/image.jpg&lt;/URI&gt;
   &lt;URI&gt;https://xprocref.org/index.html&lt;/URI&gt;
&lt;/URIs&gt;</pre></div><p class="para keep-with-next">Pipeline document:</p><div class="programlisting"><pre class="programlisting">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt;

  &lt;p:input port="source"/&gt;
  &lt;p:output port="result"/&gt;

  &lt;p:make-absolute-uris match="URI" base-uri="file:///X/Y/Z/"/&gt;

&lt;/p:declare-step&gt;</pre></div><p class="para keep-with-next">Result document:</p><div class="programlisting"><pre class="programlisting">&lt;URIs&gt;
   &lt;URI&gt;file:/…/…/image.jpg&lt;/URI&gt;
   &lt;URI&gt;file:/…/…/file:/X/Y/Z/A/B/C/&lt;/URI&gt;
   &lt;URI&gt;file:/…/…/image.jpg&lt;/URI&gt;
   &lt;URI&gt;https://xprocref.org/index.html&lt;/URI&gt;
&lt;/URIs&gt;</pre></div><p class="para">Just to show you the difference, this is what happens when you omit the final <code class="code">/</code> from the <code class="code option">base-uri</code> option. Its
      value, <code class="code">file:///X/Y/Z</code>, now points to a <span class="emphasis italic">document</span> called <code class="code">Z</code>. The URIs are resolved against the
      location of this document.</p><p class="para keep-with-next">Pipeline document:</p><div class="programlisting"><pre class="programlisting">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt;

  &lt;p:input port="source"/&gt;
  &lt;p:output port="result"/&gt;

  &lt;p:make-absolute-uris match="URI" base-uri="file:///X/Y/Z"/&gt;
  
&lt;/p:declare-step&gt;</pre></div><p class="para keep-with-next">Result document:</p><div class="programlisting"><pre class="programlisting">&lt;URIs&gt;
   &lt;URI&gt;file:/…/…/image.jpg&lt;/URI&gt;
   &lt;URI&gt;file:/…/…/file:/X/Y/A/B/C/&lt;/URI&gt;
   &lt;URI&gt;file:/…/…/image.jpg&lt;/URI&gt;
   &lt;URI&gt;https://xprocref.org/index.html&lt;/URI&gt;
&lt;/URIs&gt;</pre></div></div></div><div class="sect2" id="sect2-d420e38513"><a name="sect2-d420e38513"><!----></a><h2 class="sect2">Additional details</h2><ul class="itemizedlist"><li><p class="para"><code class="code step">p:make-absolute-uris</code> preserves all document-properties of the document(s) appearing on its <code class="code port">source</code> port.</p></li><li><p class="para">The <code class="code option">match</code> option must match attributes or elements. If anything else is matched, error <code class="code"><a href="#error-XC0023"><span class="link">XC0023</span></a></code> is
      raised.</p></li><li><p class="para">A relative value for the <code class="code option">base-uri</code> option is resolved against the base URI of the element on which this option is specified.
      In most cases this will be the static base URI of your pipeline (the path where the XProc source containing the <code class="code step">p:make-absolute-uris</code> is stored). This is very
      probably not what you want. </p></li><li><p class="para">If no <code class="code option">base-uri</code> option is specified and an element/attribute matched has no base URI also, the result is
      implementation-defined and therefore dependent on the XProc processor used.</p></li></ul></div><div class="sect2" id="sect2-d420e38549"><a name="sect2-d420e38549"><!----></a><h2 class="sect2">Errors raised</h2><div class="table nonumber error-codes-table"><table class="table nonumber error-codes-table"><thead><tr><th><p class="para">Error code</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para" id="error-XC0023"><a name="error-XC0023"><!----></a><a href="../error-codes.html#error-XC0023"><span class="link"><code class="code">XC0023</code></span></a></p></td><td><p class="para">It is a dynamic error if the selection pattern matches a wrong type of node.</p></td></tr><tr><td><p class="para" id="error-XD0064"><a name="error-XD0064"><!----></a><a href="../error-codes.html#error-XD0064"><span class="link"><code class="code">XD0064</code></span></a></p></td><td><p class="para">It is a dynamic error if the base URI is not both absolute and valid according to <a href="https://www.rfc-editor.org/info/rfc3986" target="_blank"><span class="link newpage">RFC&nbsp;3986</span></a> .</p></td></tr></tbody></table></div></div><div class="sect2" id="sect2-d420e38585"><a name="sect2-d420e38585"><!----></a><h2 class="sect2">Reference information</h2><p class="para">This description of the <code class="code step">p:make-absolute-uris</code> step is for XProc version: <a href="index.html"><span class="link">3.1</span></a>. This is a required step (an XProc 3.1 processor must support this).</p><p class="para">The formal specification for the <code class="code step">p:make-absolute-uris</code> step can be found <a href="https://spec.xproc.org/lastcall-2024-08/head/steps/#c.make-absolute-uris" target="_blank"><span class="link newpage">here</span></a>.</p><p class="para">The <code class="code step">p:make-absolute-uris</code> step is part of categories:</p><ul class="itemizedlist"><li><p class="para"><a href="Standard_XProc_steps.html"><span class="link">Standard XProc steps</span></a></p></li><li><p class="para"><a href="Interaction_with_the_environment.html"><span class="link">Interaction with the environment</span></a></p></li><li><p class="para"><a href="Miscellaneous.html"><span class="link">Miscellaneous</span></a></p></li></ul><p class="para">The <code class="code step">p:make-absolute-uris</code> step is also present in version:
                <a href="../3.0/p.make-absolute-uris.html"><span class="link">3.0</span></a>.</p></div></div></div><p>&nbsp;</p></body></html>