<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xtlcon="http://www.xtpxlib.nl/ns/container"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="keywords" content="xproc xprocref xml step p:os-exec os-exec program application execution execute"><link href="../css/bootstrap.min.css" rel="stylesheet"><link href="../css/xprocref.css" rel="stylesheet"><script defer src="../js/bootstrap.bundle.min.js"></script><title>&nbsp;p:os-exec (3.1)&nbsp;</title><link rel="shortcut icon" href="../images/favicon.ico"></head><body><nav class="navbar navbar-expand-sm bg-secondary navbar-dark "><div class="container-fluid"><a class="navbar-brand" href="../index.html"><img src="../images/logo.png" class="img-fluid" width="18%"></a></div><div class="container-fluid"><ul class="nav justify-content-end nav-pills text-light"><li class="nav-item lead"><a class="nav-link text-light" href="../index.html">home</a></li><li class="nav-item lead"><a class="nav-link text-light" href="../3.1/categories.html">categories</a></li><li class="nav-item dropdown lead"><a class="nav-link dropdown-toggle text-light" data-bs-toggle="dropdown" href="#">info</a><ul class="dropdown-menu"><li class="lead"><a class="dropdown-item" href="../versions.html">Versions</a></li><li class="lead"><a class="dropdown-item" href="../error-codes.html">Error codes</a></li><li class="lead"><a class="dropdown-item" href="../namespaces.html">Namespaces</a></li><li class="lead"><a class="dropdown-item" href="https://xproc.org">XProc</a></li><li class="lead"><a class="dropdown-item" href="https://github.com/xatapult/xprocref">Site GitHub</a></li><li class="lead"><a class="dropdown-item" href="https://github.com/xatapult/xprocref/issues">Site issues</a></li></ul></li><li class="nav-item lead"><a class="nav-link text-light" href="../about.html">about</a></li></ul></div></nav><div class="container pt-5"><div class="sect1" id="sect1-d645e23774"><a name="sect1-d645e23774"><!----></a><h1 class="sect1"><a href="p.namespace-rename.html"><span class="link"><img src="../images/previous.png" class="inlinemediaobject next-prev-marker" width="1.5%"></span></a>&nbsp;p:os-exec (3.1)&nbsp;<a href="p.os-info.html"><span class="link"><img src="../images/next.png" class="inlinemediaobject next-prev-marker" width="1.5%"></span></a></h1><p class="para">Runs an external command.</p><ul class="itemizedlist toc toc-2"><li><p class="para tocentry tocentry-2"><a href="#sect2-d645e23787"><span class="link">Summary</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d645e24227"><span class="link">Description</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d645e24262"><span class="link">Examples</span></a></p><ul class="itemizedlist toc toc-3"><li><p class="para tocentry tocentry-3"><a href="#sect3-d645e24265"><span class="link">Basic usage</span></a></p></li></ul></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d645e24313"><span class="link">Additional details</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d645e24326"><span class="link">Errors raised</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d645e24401"><span class="link">Reference information</span></a></p></li></ul><div class="sect2" id="sect2-d645e23787"><a name="sect2-d645e23787"><!----></a><h2 class="sect2">Summary</h2><div class="programlisting step-signature"><pre class="programlisting step-signature">&lt;p:declare-step type="p:os-exec"&gt;
  &lt;input port="source" primary="true" content-types="any" sequence="true"/&gt;
  &lt;output port="result" primary="true" content-types="any" sequence="true"/&gt;
  &lt;output port="error" primary="false" content-types="any" sequence="true"/&gt;
  &lt;output port="exit-status" primary="false" content-types="application/xml" sequence="false"/&gt;
  &lt;option name="command" as="xs:string" required="true"/&gt;
  &lt;option name="args" as="xs:string*" required="false" select="()"/&gt;
  &lt;option name="cwd" as="xs:string?" required="false" select="()"/&gt;
  &lt;option name="error-content-type" as="xs:string" required="false" select="'text/plain'"/&gt;
  &lt;option name="failure-threshold" as="xs:integer?" required="false" select="()"/&gt;
  &lt;option name="path-separator" as="xs:string?" required="false" select="()"/&gt;
  &lt;option name="result-content-type" as="xs:string" required="false" select="'text/plain'"/&gt;
  &lt;option name="serialization" as="map(xs:QName,item()*)?" required="false" select="()"/&gt;
&lt;/p:declare-step&gt;</pre></div><p class="para">The <code class="code step">p:os-exec</code> step runs the external command as specified in the <code class="code option">command</code> and <code class="code option">args</code> options. It passes the
      input that arrives on its <code class="code port">source</code> port as standard input to the command. The standard output and standard error of the command are
      returned on the <code class="code port">result</code> and <code class="code port">error</code> ports.</p><p class="para table-header">Ports:</p><div class="table nonumber ports-table"><table class="table nonumber ports-table"><thead><tr><th><p class="para">Port</p></th><th><p class="para">Type</p></th><th><p class="para">Primary?</p></th><th><p class="para">Content types</p></th><th><p class="para">Seq?</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para"><code class="code">source</code></p></td><td><p class="para"><code class="code">input</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para"><code class="code">any</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para">The document that appears on the standard input of the external command. If the <code class="code port">source</code> port is empty, the command receives
          nothing on standard input.</p><p class="para">This document is serialized (as if written to disk) first. For this, the value of the <code class="code property">serialization</code>
          document-property and that of the <code class="code option">serialization</code> option are used. See the <code class="code option">serialization</code> option for more
          information.</p><p class="para">The port accepts zero or one document. For multiple documents, error <code class="code"><a href="#error-XC0032"><span class="link">XC0032</span></a></code> is raised.</p><p class="para">If you want the source port to be empty, you must specify this:</p><div class="programlisting"><pre class="programlisting">&lt;p:with-input port="source"&gt;
  &lt;p:empty/&gt;
&lt;/p:with-input&gt;</pre></div></td></tr><tr><td><p class="para"><code class="code">result</code></p></td><td><p class="para"><code class="code">output</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para"><code class="code">any</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para">The result of the external command: what was written by the command on the standard output.</p><p class="para">The standard output of the command is processed as if it was read from disk by <code class="code step"><a href="p.load.html"><span class="link">p:load</span></a></code>. The value of the
            <code class="code option">result-content-type</code> option of <code class="code step">p:os-exec</code> is taken as the value for the <code class="code option">content-type</code> option of <code class="code step"><a href="p.load.html"><span class="link">p:load</span></a></code>.</p><p class="para">If there is no content on the standard output, this port will be empty.</p></td></tr><tr><td><p class="para"><code class="code">error</code></p></td><td><p class="para"><code class="code">output</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">any</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para">The error result of the external command: what was written by the command on the standard error.</p><p class="para">The standard error of the command is processed as if it was read from disk by <code class="code step"><a href="p.load.html"><span class="link">p:load</span></a></code>. The value of the
            <code class="code option">error-content-type</code> option of <code class="code step">p:os-exec</code> is taken as the value for the <code class="code option">content-type</code> option of <code class="code step"><a href="p.load.html"><span class="link">p:load</span></a></code>.</p><p class="para">If there is no content on the standard error, this port will be empty.</p></td></tr><tr><td><p class="para"><code class="code">exit-status</code></p></td><td><p class="para"><code class="code">output</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">application/xml</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para">A <code class="tag">&lt;c:result&gt;</code> element containing the system exit status, as an integer (the <code class="code">c</code> prefix here is bound to the
            <code class="code">http://www.w3.org/ns/xproc-step</code> namespace).</p></td></tr></tbody></table></div><p class="para table-header">Options:</p><div class="table nonumber options-table"><table class="table nonumber options-table"><thead><tr><th><p class="para">Name</p></th><th><p class="para">Type</p></th><th><p class="para">Req?</p></th><th><p class="para">Default</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para"><code class="code">command</code></p></td><td><p class="para"><code class="code">xs:string</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para"><code class="code">&nbsp;</code></p></td><td><p class="para">The external command to execute (without arguments).</p></td></tr><tr><td><p class="para"><code class="code">args</code></p></td><td><p class="para"><code class="code">xs:string*</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">()</code></p></td><td><p class="para">The arguments for the external command (as a sequence of strings).</p></td></tr><tr><td><p class="para"><code class="code">cwd</code></p></td><td><p class="para"><code class="code">xs:string?</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">()</code></p></td><td><p class="para">The current working directory for the execution of the command.</p><p class="para">If this option is left unspecified, the current working directory will be implementation-defined and therefore depends on the XProc
          processor used.</p><p class="para">To resolve variations in the syntax of directory specifications, the value supplied for this option will be normalized using the
              <code class="code"><a href="https://spec.xproc.org/master/head/xproc/#f.urify" target="_blank"><span class="link newpage">p:urify()</span></a></code> function.</p></td></tr><tr><td><p class="para"><code class="code">error-content-type</code></p></td><td><p class="para"><code class="code">xs:string</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">text/plain</code></p></td><td><p class="para">The content type of the command’s error result (its standard error). See the description of the <code class="code port">error</code> port.</p></td></tr><tr><td><p class="para"><code class="code">failure-threshold</code></p></td><td><p class="para"><code class="code">xs:integer?</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">()</code></p></td><td><p class="para">If a value for this option is supplied and the command exit status is greater than this value, error <code class="code"><a href="#error-XC0064"><span class="link">XC0064</span></a></code> is
          raised.</p></td></tr><tr><td><p class="para"><code class="code">path-separator</code></p></td><td><p class="para"><code class="code">xs:string?</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">()</code></p></td><td><p class="para">If specified, every occurrence of this character that occurs in the <code class="code option">command</code>, <code class="code option">args</code>, or
            <code class="code option">cwd</code> options will be replaced by the platform-specific path separator character.</p><p class="para">The value for this option must be exactly one character long. if not, error <code class="code"><a href="#error-XC0063"><span class="link">XC0063</span></a></code> is raised.</p></td></tr><tr><td><p class="para"><code class="code">result-content-type</code></p></td><td><p class="para"><code class="code">xs:string</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">text/plain</code></p></td><td><p class="para">The content type of the command’s result (its standard output). See the description of the <code class="code port">result</code> port.</p></td></tr><tr><td><p class="para"><code class="code">serialization</code></p></td><td><p class="para"><code class="code">map(xs:QName,item()*)?</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">()</code></p></td><td><p class="para">This option can supply a map with <a href="https://www.w3.org/TR/xslt-xquery-serialization-31/" target="_blank"><span class="link newpage">serialization
            properties</span></a> for serializing the document on the <code class="code port">source</code> port, before it is passed as the standard input of the
          command.</p><p class="para">If the source document has a <code class="code property">serialization</code> document-property, the two sets of serialization properties are merged
    (properties in the document-property have precedence).</p><p class="para">Example: <code class="code">serialization="map{'method':&nbsp;'text'}"</code></p></td></tr></tbody></table></div></div><div class="sect2" id="sect2-d645e24227"><a name="sect2-d645e24227"><!----></a><h2 class="sect2">Description</h2><p class="para">The <code class="code step">p:os-exec</code> step can be used to run an external command. For instance, a Python script or post-process some result with something not
      available in XProc.</p><p class="para">The command itself is specified using the <code class="code option">command</code> and <code class="code option">args</code> options. Every string in the
        <code class="code option">args</code> option is a separate argument (also when it contains spaces). What appears on the <code class="code port">result</code> port is passed as
      the command’s standard input.</p><p class="para">The command’s output and error information is returned on the <code class="code port">result</code> and <code class="code port">error</code> ports. You can use the
        <code class="code option">result-content-type</code> and <code class="code option">error-content-type</code> options to tailor how this comes out.</p></div><div class="sect2" id="sect2-d645e24262"><a name="sect2-d645e24262"><!----></a><h2 class="sect2">Examples</h2><div class="sect3" id="sect3-d645e24265"><a name="sect3-d645e24265"><!----></a><h3 class="sect3">Basic usage</h3><p class="para">This example runs the (Windows) <code class="code">dir</code> command (that shows a directory overview) on the <code class="code">data/</code> subdirectory of where
      the pipeline is stored. It does so by starting the Windows command processor (called <code class="code">cmd</code>) with the arguments
        <code class="code">/C&nbsp;dir&nbsp;data</code>. This is the same as typing <code class="code">dir&nbsp;data</code> on the Windows command line.</p><p class="para">A problem we have here is that we need to set the current working directory (in the <code class="code option">cwd</code>) to the location of the pipeline.
      The example computes this, based on the <code class="code">static-base-uri()</code> of the pipeline, using regular expression magic. The <code class="code option">cwd</code>
      option of <code class="code step">p:os-exec</code> does not accept a URI, so we have to strip the <code class="code">file:/</code> in front also. The result is stored in the
        <code class="code">$cwd</code> variable.</p><p class="para keep-with-next">Pipeline document:</p><div class="programlisting"><pre class="programlisting">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt;

  &lt;p:output port="result"/&gt;

  &lt;p:variable name="cwd" select="static-base-uri() =&amp;gt; replace('^file:/+', '') =&amp;gt; replace('[^/\\]+$', '')"/&gt;

  &lt;p:os-exec command="cmd" cwd="{$cwd}"&gt;
    &lt;p:with-option name="args" select="('/C', 'dir', 'data')"/&gt;
    &lt;p:with-input port="source"&gt;
      &lt;p:empty/&gt;
    &lt;/p:with-input&gt;
  &lt;/p:os-exec&gt;
  
&lt;/p:declare-step&gt;</pre></div><p class="para">Result document (text):</p><div class="programlisting"><pre class="programlisting">Volume in drive C is OS
 Volume Serial Number is 9EA2-E853

 Directory of C:\…\data

08/01/2025  11:47    &lt;DIR&gt;          .
08/01/2025  11:47    &lt;DIR&gt;          ..
05/02/2025  13:05                46 x1.xml
05/02/2025  13:05                46 x2.xml
               2 File(s)             92 bytes
               2 Dir(s)  508.968.566.784 bytes free</pre></div></div></div><div class="sect2" id="sect2-d645e24313"><a name="sect2-d645e24313"><!----></a><h2 class="sect2">Additional details</h2><ul class="itemizedlist"><li><p class="para">The documents appearing on the output ports only have a <code class="code property">content-type</code> property. They have no other document-properties
      (also no <code class="code property">base-uri</code>).</p></li></ul></div><div class="sect2" id="sect2-d645e24326"><a name="sect2-d645e24326"><!----></a><h2 class="sect2">Errors raised</h2><div class="table nonumber error-codes-table"><table class="table nonumber error-codes-table"><thead><tr><th><p class="para">Error code</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para" id="error-XC0032"><a name="error-XC0032"><!----></a><a href="../error-codes.html#error-XC0032"><span class="link"><code class="code">XC0032</code></span></a></p></td><td><p class="para">It is a dynamic error if more than one document appears on the <code class="code port">source</code> port of the <code class="tag">&lt;p:os-exec&gt;</code> step.</p></td></tr><tr><td><p class="para" id="error-XC0033"><a name="error-XC0033"><!----></a><a href="../error-codes.html#error-XC0033"><span class="link"><code class="code">XC0033</code></span></a></p></td><td><p class="para">It is a dynamic error if the command cannot be run.</p></td></tr><tr><td><p class="para" id="error-XC0034"><a name="error-XC0034"><!----></a><a href="../error-codes.html#error-XC0034"><span class="link"><code class="code">XC0034</code></span></a></p></td><td><p class="para">It is a dynamic error if the current working directory cannot be changed to the value of the <code class="code option">cwd</code> option.</p></td></tr><tr><td><p class="para" id="error-XC0063"><a name="error-XC0063"><!----></a><a href="../error-codes.html#error-XC0063"><span class="link"><code class="code">XC0063</code></span></a></p></td><td><p class="para">It is a dynamic error if the <code class="code option">path-separator</code> option is specified and is not exactly one character long.</p></td></tr><tr><td><p class="para" id="error-XC0064"><a name="error-XC0064"><!----></a><a href="../error-codes.html#error-XC0064"><span class="link"><code class="code">XC0064</code></span></a></p></td><td><p class="para">It is a dynamic error if the exit code from the command is greater than the specified <code class="code option">failure-threshold</code> value.</p></td></tr></tbody></table></div></div><div class="sect2" id="sect2-d645e24401"><a name="sect2-d645e24401"><!----></a><h2 class="sect2">Reference information</h2><p class="para">This description of the <code class="code step">p:os-exec</code> step is for XProc version: <a href="../index.html"><span class="link">3.1</span></a>. This is a non-required step (an XProc 3.1 processor does not have to support this).</p><p class="para">The formal specification for the <code class="code step">p:os-exec</code> step can be found <a href="https://spec.xproc.org/master/head/os/#c.os-exec" target="_blank"><span class="link newpage">here</span></a>.</p><p class="para">The <code class="code step">p:os-exec</code> step is part of categories:</p><ul class="itemizedlist"><li><p class="para"><a href="XProc_operating_system_related_steps.html"><span class="link">XProc operating system related steps</span></a></p></li><li><p class="para"><a href="Interaction_with_the_environment.html"><span class="link">Interaction with the environment</span></a></p></li></ul><p class="para">The <code class="code step">p:os-exec</code> step is also present in version:
                <a href="../3.0/p.os-exec.html"><span class="link">3.0</span></a>.</p></div></div></div><p>&nbsp;</p></body></html>