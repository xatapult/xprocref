<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xtlcon="http://www.xtpxlib.nl/ns/container"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="keywords" content="xproc xprocref xml step p:invisible-xml invisible-xml invisible xml"><link href="../css/bootstrap.min.css" rel="stylesheet"><link href="../css/xprocref.css" rel="stylesheet"><script defer src="../js/bootstrap.bundle.min.js"></script><title>&nbsp;p:invisible-xml (3.1)&nbsp;</title><link rel="shortcut icon" href="../images/favicon.ico"></head><body><nav class="navbar navbar-expand-sm bg-secondary navbar-dark "><div class="container-fluid"><a class="navbar-brand" href="../index.html"><img src="../images/logo.png" class="img-fluid" width="18%"></a></div><div class="container-fluid"><ul class="nav justify-content-end nav-pills text-light"><li class="nav-item lead"><a class="nav-link text-light" href="../index.html">home</a></li><li class="nav-item lead"><a class="nav-link text-light" href="../3.1/categories.html">categories</a></li><li class="nav-item dropdown lead"><a class="nav-link dropdown-toggle text-light" data-bs-toggle="dropdown" href="#">info</a><ul class="dropdown-menu"><li class="lead"><a class="dropdown-item" href="../versions.html">Versions</a></li><li class="lead"><a class="dropdown-item" href="../error-codes.html">Error codes</a></li><li class="lead"><a class="dropdown-item" href="../namespaces.html">Namespaces</a></li><li class="lead"><a class="dropdown-item" href="https://xproc.org">XProc</a></li><li class="lead"><a class="dropdown-item" href="https://github.com/xatapult/xprocref">Site GitHub</a></li><li class="lead"><a class="dropdown-item" href="https://github.com/xatapult/xprocref/issues">Site issues</a></li></ul></li><li class="nav-item lead"><a class="nav-link text-light" href="../about.html">about</a></li></ul></div></nav><div class="container pt-5"><div class="sect1" id="sect1-d626e20613"><a name="sect1-d626e20613"><!----></a><h1 class="sect1"><a href="p.insert.html"><span class="link"><img src="../images/previous.png" class="inlinemediaobject next-prev-marker" width="1.5%"></span></a>&nbsp;p:invisible-xml (3.1)&nbsp;<a href="p.json-join.html"><span class="link"><img src="../images/next.png" class="inlinemediaobject next-prev-marker" width="1.5%"></span></a></h1><p class="para keep-with-next">Performs invisible XML processing.</p><ul class="itemizedlist toc toc-2"><li><p class="para tocentry tocentry-2"><a href="#sect2-d626e20626"><span class="link">Summary</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d626e20884"><span class="link">Description</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d626e20919"><span class="link">Examples</span></a></p><ul class="itemizedlist toc toc-3"><li><p class="para tocentry tocentry-3"><a href="#p_invisible-xml-v31-basic-usage"><span class="link">Basic usage</span></a></p></li><li><p class="para tocentry tocentry-3"><a href="#p_invisible-xml-v31-parse-ixml"><span class="link">Parsing the invisible XML grammar</span></a></p></li></ul></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d626e20958"><span class="link">Additional details</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d626e20980"><span class="link">Errors raised</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d626e21025"><span class="link">Reference information</span></a></p></li></ul><div class="sect2" id="sect2-d626e20626"><a name="sect2-d626e20626"><!----></a><h2 class="sect2">Summary</h2><div class="programlisting step-signature"><pre class="programlisting step-signature">&lt;p:declare-step type="p:invisible-xml"&gt;
  &lt;input port="source" primary="true" content-types="any -xml -html" sequence="false"/&gt;
  &lt;output port="result" primary="true" content-types="any" sequence="true"/&gt;
  &lt;input port="grammar" primary="false" content-types="text xml" sequence="true"/&gt;
  &lt;option name="fail-on-error" as="xs:boolean" required="false" select="true()"/&gt;
  &lt;option name="parameters" as="map(xs:QName, item()*)?" required="false" select="()"/&gt;
&lt;/p:declare-step&gt;</pre></div><p class="para">The <code class="code step">p:invisible-xml</code> step parses the document on the <code class="code port">source</code> port using <a href="https://invisiblexml.org/1.0/" target="_blank"><span class="link newpage">invisible XML</span></a>. The grammar for this must be provided on the <code class="code port">grammar</code> port. The result will be emitted on the
        <code class="code port">result</code> port.</p><p class="para table-header keep-with-next">Ports:</p><div class="table nonumber ports-table"><table class="table nonumber ports-table"><thead><tr><th><p class="para">Port</p></th><th><p class="para">Type</p></th><th><p class="para">Primary?</p></th><th><p class="para">Content types</p></th><th><p class="para">Seq?</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para"><code class="code">source</code></p></td><td><p class="para"><code class="code">input</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para"><code class="code">any -xml -html</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para">The source document to parse using the <a href="https://invisiblexml.org/1.0/" target="_blank"><span class="link newpage">invisible XML grammar</span></a>
          provided on the <code class="code port">grammar</code> port.</p><p class="para">If the <code class="code port">grammar</code> port is empty, this must contain a valid <a href="https://invisiblexml.org/1.0/" target="_blank"><span class="link newpage">invisible XML grammar</span></a>. See the description of the <code class="code port">grammar</code> port.</p></td></tr><tr><td><p class="para"><code class="code">result</code></p></td><td><p class="para"><code class="code">output</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para"><code class="code">any</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para">The result of parsing the document on the <code class="code port">source</code> port.</p></td></tr><tr><td><p class="para"><code class="code">grammar</code></p></td><td><p class="para"><code class="code">input</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">text xml</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para">One of the following:</p><ul class="itemizedlist"><li><p class="para">A single document containing the <a href="https://invisiblexml.org/1.0/" target="_blank"><span class="link newpage">invisible XML grammar</span></a> to use
              for parsing the document on the <code class="code port">source</code> port. This grammar can either be in text or XML format.</p></li><li><p class="para">If empty, the document on the <code class="code port">source</code> must contain a valid <a href="https://invisiblexml.org/1.0/" target="_blank"><span class="link newpage">invisible XML grammar</span></a>. This is converted to its XML representation and returned on the <code class="code port">result</code> port.
              See <a href="#p_invisible-xml-v31-parse-ixml"><span class="link">Parsing the invisible XML grammar</span></a> for an example.</p></li></ul></td></tr></tbody></table></div><p class="para table-header keep-with-next">Options:</p><div class="table nonumber options-table"><table class="table nonumber options-table"><thead><tr><th><p class="para">Name</p></th><th><p class="para">Type</p></th><th><p class="para">Req?</p></th><th><p class="para">Default</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para"><code class="code">fail-on-error</code></p></td><td><p class="para"><code class="code">xs:boolean</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para">Determines what happens if the document cannot be parsed:</p><ul class="itemizedlist"><li><p class="para">If <code class="code">true</code>, error <a href="#error-XC0205"><span class="link"><code class="code">XC0205</code></span></a> is raised.</p></li><li><p class="para">If <code class="code">false</code>, the step always succeeds. The <a href="https://invisiblexml.org/1.0/" target="_blank"><span class="link newpage">invisible XML
                specification</span></a> provides a mechanism to identify failed parses in the output.</p></li></ul></td></tr><tr><td><p class="para"><code class="code">parameters</code></p></td><td><p class="para"><code class="code">map(xs:QName, item()*)?</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">()</code></p></td><td><p class="para">Parameters used to control the parsing. The XProc specification does not define any parameters for this option. A specific XProc
          processor (or parser used) might define its own.</p></td></tr></tbody></table></div></div><div class="sect2" id="sect2-d626e20884"><a name="sect2-d626e20884"><!----></a><h2 class="sect2">Description</h2><p class="para">Invisible XML (or ixml) is a method for treating non-XML documents as if they were XML, enabling authors to write documents and data in a
      format they prefer while providing XML for processes that are more effective with XML content.</p><p class="para">The <code class="code step">p:invisible-xml</code> takes a document, usually text, and parses this using an <a href="https://invisiblexml.org/1.0/" target="_blank"><span class="link newpage">invisible XML grammar</span></a> into an XML document. The grammar must be provided on the <code class="code port">grammar</code> port. The result will appear on
      the <code class="code port">result</code> port.</p><p class="para">Invisible XML has both a text and an XML representation and you can use both representations on the <code class="code port">grammar</code> port. Converting
      the text to the XML grammar can be done by leaving the <code class="code port">grammar</code> port empty and providing the text based grammar on the
        <code class="code port">source</code> port. See <a href="#p_invisible-xml-v31-parse-ixml"><span class="link">Parsing the invisible XML grammar</span></a> for an example. </p><p class="para">In most cases, <code class="code step">p:invisible-xml</code> relies on an external parser. You’ll probably have to do some XProc processor dependent configuration before
      this step will work. Please consult the XProc processor documentation about this.</p></div><div class="sect2" id="sect2-d626e20919"><a name="sect2-d626e20919"><!----></a><h2 class="sect2">Examples</h2><div class="sect3" id="p_invisible-xml-v31-basic-usage"><a name="p_invisible-xml-v31-basic-usage"><!----></a><h3 class="sect3">Basic usage</h3><p class="para">We’re going to use a very basic <a href="https://invisiblexml.org/1.0/" target="_blank"><span class="link newpage">invisible XML grammar</span></a> that
      parses a written date into XML. The grammar looks like this:</p><div class="programlisting"><pre class="programlisting">date: s?, day, s, month, (s, year)? .
-s: -" "+ .
day: digit, digit? .
-digit: "0"; "1"; "2"; "3"; "4"; "5"; "6"; "7"; "8"; "9".
month: "January"; "February"; "March"; "April";
       "May"; "June"; "July"; "August";
       "September"; "October"; "November"; "December".
year: (digit, digit)?, digit, digit .</pre></div><p class="para">The input document is:</p><div class="programlisting"><pre class="programlisting">31 December 2021</pre></div><p class="para">Using the <code class="code step">p:invisible-xml</code> step to parse this, the result is as follows:</p><div class="programlisting"><pre class="programlisting">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt;

  &lt;p:input port="source"/&gt;
  &lt;p:output port="result"/&gt;

  &lt;p:invisible-xml&gt;
    &lt;p:with-input port="grammar" href="grammar.txt"/&gt;
  &lt;/p:invisible-xml&gt;

&lt;/p:declare-step&gt;</pre></div><p class="para keep-with-next">Result document:</p><div class="programlisting"><pre class="programlisting">&lt;date&gt;
   &lt;day&gt;31&lt;/day&gt;
   &lt;month&gt;December&lt;/month&gt;
   &lt;year&gt;2021&lt;/year&gt;
&lt;/date&gt;</pre></div></div><div class="sect3" id="p_invisible-xml-v31-parse-ixml"><a name="p_invisible-xml-v31-parse-ixml"><!----></a><h3 class="sect3">Parsing the invisible XML grammar</h3><p class="para">We can parse the text representation of an invisible XML grammar into its XML representation by leaving the <code class="code port">grammar</code> port empty
      and provide the text grammar on the <code class="code port">source</code> port. Using the same grammar as in <a href="#p_invisible-xml-v31-basic-usage"><span class="link">Basic usage</span></a>, the result
      is:</p><p class="para keep-with-next">Pipeline document:</p><div class="programlisting"><pre class="programlisting">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt;

  &lt;p:input port="source"/&gt;
  &lt;p:output port="result"/&gt;

  &lt;p:invisible-xml&gt;
    &lt;p:with-input port="grammar"&gt;
      &lt;p:empty/&gt;
    &lt;/p:with-input&gt;
  &lt;/p:invisible-xml&gt;

&lt;/p:declare-step&gt;</pre></div><p class="para keep-with-next">Result document:</p><div class="programlisting"><pre class="programlisting">&lt;ixml&gt;
   &lt;rule name="date"&gt;
      &lt;alt&gt;
         &lt;option&gt;
            &lt;nonterminal name="s"/&gt;
         &lt;/option&gt;
         &lt;nonterminal name="day"/&gt;
         &lt;nonterminal name="s"/&gt;
         &lt;nonterminal name="month"/&gt;
         &lt;option&gt;
            &lt;alts&gt;
               &lt;alt&gt;
                  &lt;nonterminal name="s"/&gt;
                  &lt;nonterminal name="year"/&gt;
               &lt;/alt&gt;
            &lt;/alts&gt;
         &lt;/option&gt;
      &lt;/alt&gt;
   &lt;/rule&gt;
   &lt;rule mark="-" name="s"&gt;
      &lt;alt&gt;
         &lt;repeat1&gt;
            &lt;literal tmark="-" string=" "/&gt;
         &lt;/repeat1&gt;
      &lt;/alt&gt;
   &lt;/rule&gt;
   &lt;rule name="day"&gt;
      &lt;alt&gt;
         &lt;nonterminal name="digit"/&gt;
         &lt;option&gt;
            &lt;nonterminal name="digit"/&gt;
         &lt;/option&gt;
      &lt;/alt&gt;
   &lt;/rule&gt;
   &lt;rule mark="-" name="digit"&gt;
      &lt;alt&gt;
         &lt;literal string="0"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="1"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="2"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="3"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="4"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="5"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="6"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="7"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="8"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="9"/&gt;
      &lt;/alt&gt;
   &lt;/rule&gt;
   &lt;rule name="month"&gt;
      &lt;alt&gt;
         &lt;literal string="January"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="February"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="March"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="April"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="May"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="June"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="July"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="August"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="September"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="October"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="November"/&gt;
      &lt;/alt&gt;
      &lt;alt&gt;
         &lt;literal string="December"/&gt;
      &lt;/alt&gt;
   &lt;/rule&gt;
   &lt;rule name="year"&gt;
      &lt;alt&gt;
         &lt;option&gt;
            &lt;alts&gt;
               &lt;alt&gt;
                  &lt;nonterminal name="digit"/&gt;
                  &lt;nonterminal name="digit"/&gt;
               &lt;/alt&gt;
            &lt;/alts&gt;
         &lt;/option&gt;
         &lt;nonterminal name="digit"/&gt;
         &lt;nonterminal name="digit"/&gt;
      &lt;/alt&gt;
   &lt;/rule&gt;
&lt;/ixml&gt;</pre></div></div></div><div class="sect2" id="sect2-d626e20958"><a name="sect2-d626e20958"><!----></a><h2 class="sect2">Additional details</h2><ul class="itemizedlist"><li><p class="para">The document appearing on the <code class="code port">result</code> port only has a <code class="code property">content-type</code> property. It has no other
    document-properties (also no <code class="code property">base-uri</code>).</p></li><li><p class="para">The resulting document will in the vast majority of cases be XML. However, the implementation allows for returning other document types. If,
      how and when this happens is implementation defined and therefore dependent on the XProc processor used.</p></li></ul></div><div class="sect2" id="sect2-d626e20980"><a name="sect2-d626e20980"><!----></a><h2 class="sect2">Errors raised</h2><div class="table nonumber error-codes-tablee"><table class="table nonumber error-codes-tablee"><thead><tr><th><p class="para">Error code</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para" id="error-XC0205"><a name="error-XC0205"><!----></a><a href="../error-codes.html#error-XC0205"><span class="link"><code class="code">XC0205</code></span></a></p></td><td><p class="para">It is a dynamic error if the source document cannot be parsed by the provided grammar.</p></td></tr><tr><td><p class="para" id="error-XC0211"><a name="error-XC0211"><!----></a><a href="../error-codes.html#error-XC0211"><span class="link"><code class="code">XC0211</code></span></a></p></td><td><p class="para">It is a dynamic error if more than one document appears on the <code class="code port">grammar</code> port.</p></td></tr><tr><td><p class="para" id="error-XC0212"><a name="error-XC0212"><!----></a><a href="../error-codes.html#error-XC0212"><span class="link"><code class="code">XC0212</code></span></a></p></td><td><p class="para">It is a dynamic error if the grammar provided is not a valid Invisible XML grammar.</p></td></tr></tbody></table></div></div><div class="sect2 reference-section" id="sect2-d626e21025"><a name="sect2-d626e21025"><!----></a><h2 class="sect2 reference-section">Reference information</h2><p class="para">This description of the <code class="code step">p:invisible-xml</code> step is for XProc version: <a href="../index.html"><span class="link">3.1</span></a>. This is a required step (an XProc 3.1 processor must support this).</p><p class="para">The formal specification for the <code class="code step">p:invisible-xml</code> step can be found <a href="https://spec.xproc.org/master/head/ixml/#c.ixml" target="_blank"><span class="link newpage specification-link">here</span></a>.</p><p class="para">The <code class="code step">p:invisible-xml</code> step is part of categories:</p><ul class="itemizedlist"><li><p class="para"><a href="XProc_Invisible_XML_related_steps.html"><span class="link">XProc Invisible XML related steps</span></a></p></li><li><p class="para"><a href="Additional_standards.html"><span class="link">Additional standards</span></a></p></li></ul><p class="para">The <code class="code step">p:invisible-xml</code> step is also present in version:
                <a href="../3.0/p.invisible-xml.html"><span class="link">3.0</span></a>.</p></div></div></div><p>&nbsp;</p></body></html>