<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xtlcon="http://www.xtpxlib.nl/ns/container"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="keywords" content="xproc xprocref xml step p:load load"><link href="../css/bootstrap.min.css" rel="stylesheet"><link href="../css/xprocref.css" rel="stylesheet"><script defer src="../js/bootstrap.bundle.min.js"></script><title>&nbsp;p:load (3.0)&nbsp;</title><link rel="shortcut icon" href="../images/favicon.ico"></head><body><nav class="navbar navbar-expand-sm bg-secondary navbar-dark "><div class="container-fluid"><a class="navbar-brand" href="../index.html"><img src="../images/logo.png" class="img-fluid" width="18%"></a></div><div class="container-fluid"><ul class="nav justify-content-end nav-pills text-light"><li class="nav-item lead"><a class="nav-link text-light" href="../index.html">home</a></li><li class="nav-item lead"><a class="nav-link text-light" href="../3.1/categories.html">categories</a></li><li class="nav-item dropdown lead"><a class="nav-link dropdown-toggle text-light" data-bs-toggle="dropdown" href="#">info</a><ul class="dropdown-menu"><li class="lead"><a class="dropdown-item" href="../versions.html">Versions</a></li><li class="lead"><a class="dropdown-item" href="../error-codes.html">Error codes</a></li><li class="lead"><a class="dropdown-item" href="../namespaces.html">Namespaces</a></li><li class="lead"><a class="dropdown-item" href="https://xproc.org">XProc</a></li><li class="lead"><a class="dropdown-item" href="https://github.com/xatapult/xprocref">Site GitHub</a></li><li class="lead"><a class="dropdown-item" href="https://github.com/xatapult/xprocref/issues">Site issues</a></li></ul></li><li class="nav-item lead"><a class="nav-link text-light" href="../about.html">about</a></li></ul></div></nav><div class="container pt-5"><div class="sect1" id="sect1-d645e60961"><a name="sect1-d645e60961"><!----></a><h1 class="sect1"><a href="p.label-elements.html"><span class="link"><img src="../images/previous.png" class="inlinemediaobject next-prev-marker" width="1.5%"></span></a>&nbsp;p:load (3.0)&nbsp;<a href="p.make-absolute-uris.html"><span class="link"><img src="../images/next.png" class="inlinemediaobject next-prev-marker" width="1.5%"></span></a></h1><p class="para">Loads a document.</p><ul class="itemizedlist toc toc-2"><li><p class="para tocentry tocentry-2"><a href="#sect2-d645e60974"><span class="link">Summary</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d645e61176"><span class="link">Description</span></a></p><ul class="itemizedlist toc toc-3"><li><p class="para tocentry tocentry-3"><a href="#determining-content-type"><span class="link">Determining the content-type</span></a></p></li></ul></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d645e61337"><span class="link">Examples</span></a></p><ul class="itemizedlist toc toc-3"><li><p class="para tocentry tocentry-3"><a href="#sect3-d645e61340"><span class="link">Basic usage</span></a></p></li></ul></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d645e61359"><span class="link">Additional details</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d645e61414"><span class="link">Errors raised</span></a></p></li><li><p class="para tocentry tocentry-2"><a href="#sect2-d645e61586"><span class="link">Reference information</span></a></p></li></ul><div class="sect2" id="sect2-d645e60974"><a name="sect2-d645e60974"><!----></a><h2 class="sect2">Summary</h2><div class="programlisting step-signature"><pre class="programlisting step-signature">&lt;p:declare-step type="p:load"&gt;
  &lt;output port="result" primary="true" content-types="any" sequence="false"/&gt;
  &lt;option name="href" as="xs:anyURI" required="true"/&gt;
  &lt;option name="content-type" as="xs:string?" required="false" select="()"/&gt;
  &lt;option name="document-properties" as="map(xs:QName, item()*)?" required="false" select="()"/&gt;
  &lt;option name="parameters" as="map(xs:QName,item()*)?" required="false" select="()"/&gt;
&lt;/p:declare-step&gt;</pre></div><p class="para">The <code class="code step">p:load</code> loads a document indicated by a URI and returns this on its <code class="code port">result</code> port.</p><p class="para table-header">Ports:</p><div class="table nonumber ports-table"><table class="table nonumber ports-table"><thead><tr><th><p class="para">Port</p></th><th><p class="para">Type</p></th><th><p class="para">Primary?</p></th><th><p class="para">Content types</p></th><th><p class="para">Seq?</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para"><code class="code">result</code></p></td><td><p class="para"><code class="code">output</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para"><code class="code">any</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para">The loaded document.</p></td></tr></tbody></table></div><p class="para table-header">Options:</p><div class="table nonumber options-table"><table class="table nonumber options-table"><thead><tr><th><p class="para">Name</p></th><th><p class="para">Type</p></th><th><p class="para">Req?</p></th><th><p class="para">Default</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para"><code class="code">href</code></p></td><td><p class="para"><code class="code">xs:anyURI</code></p></td><td><p class="para"><code class="code">true</code></p></td><td><p class="para"><code class="code">&nbsp;</code></p></td><td><p class="para">The URI for loading the document.</p><p class="para">In most cases, <code class="code step">p:load</code> will be used to load a file from disk. An absolute URI for this must start with <code class="code">file://</code>. For
          instance, on Windows, <code class="code">file:///C:/some/path/document.xml</code> (although Windows uses backslashes (<code class="code">\</code>) to separate path
          components, slashes (<code class="code">/</code>) work fine and are more universal). Using a single slash after <code class="code">file:</code> also works:
            <code class="code">file:/C:/some/path/document.xml</code>.</p><p class="para">If this value is relative, it is resolved against the base URI of the element on which this option is specified. In most cases this will
          be the static base URI of your pipeline (the path where the XProc source containing the <code class="code step">p:load</code> step is stored).</p></td></tr><tr><td><p class="para"><code class="code">content-type</code></p></td><td><p class="para"><code class="code">xs:string?</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">()</code></p></td><td><p class="para">The content-type of the document to load, for instance <code class="code">text/plain</code> or <code class="code">application/json</code>. The document is
          interpreted according to this.</p><p class="para">If this option is not present, the content-type is determined as described in <a href="#determining-content-type" class="xref">Determining the content-type</a>.</p></td></tr><tr><td><p class="para"><code class="code">document-properties</code></p></td><td><p class="para"><code class="code">map(xs:QName, item()*)?</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">()</code></p></td><td><p class="para">Any document-properties for the loaded document.</p></td></tr><tr><td><p class="para"><code class="code">parameters</code></p></td><td><p class="para"><code class="code">map(xs:QName,item()*)?</code></p></td><td><p class="para"><code class="code">false</code></p></td><td><p class="para"><code class="code">()</code></p></td><td><p class="para">Parameters controlling the loading of the document. Some keys and values are determined by the type of document loaded (see below). Any
          additional parameters are implementation-defined and therefore dependent on the XProc processor used.</p></td></tr></tbody></table></div></div><div class="sect2" id="sect2-d645e61176"><a name="sect2-d645e61176"><!----></a><h2 class="sect2">Description</h2><p class="para">The <code class="code step">p:load</code> step is one of the few that has no <code class="code port">source</code> port. It is used to load some document from disk, the web or elsewhere,
      and returns this document on its <code class="code port">result</code> port. XProc must know what kind of document it is loading, the mechanism for this is
      described in <a href="#determining-content-type" class="xref">Determining the content-type</a>. It is also possible to set document-properties.</p><p class="para">What exactly happens depends on the loaded document’s content-type:</p><ul class="itemizedlist"><li><p class="para">For an XML document-type, the document is loaded and interpreted (de-serialized) as XML.</p><p class="para">There is one pre-defined parameter for the <code class="code option">parameters</code> option: <code class="code">dtd-validate</code> (<code class="code">xs:boolean</code>). If
            <code class="code">true</code>, DTD validation must be performed when parsing the document.</p></li><li><p class="para">Text document-types are loaded “as-is”. </p></li><li><p class="para">For a JSON document-type, the document is loaded and interpreted (de-serialized) as JSON.</p><p class="para">The <code class="code option">parameters</code> option recognizes the parsing options as defined for the XPath <a href="https://www.w3.org/TR/xpath-functions-31/#func-parse-json" target="_blank"><span class="link newpage"><code class="code">parse-json()</code></span></a> function (the
            <code class="code">$options</code> argument).</p></li><li><p class="para">For an HTML document-type, the document is loaded and parsed into well-formed XML, even although HTML documents do not have to be
          well-formed. How this is done exactly is implementation-defined and therefore dependent on the XProc processor used.</p></li><li><p class="para">For any other document-type, the document is loaded as a binary document.</p></li></ul><p class="para">There are many ways to load a document into an XProc pipeline. For instance, you could use the <code class="code">href</code> attribute of
        <code class="tag">&lt;p:with-input&gt;</code>, or use its <code class="tag">&lt;p:document&gt;</code> child element. The <code class="tag">&lt;p:document&gt;</code> element is even
        <span class="emphasis italic">defined</span> as having the same functionality as <code class="code step">p:load</code>, so there’s no difference in functionality.</p><p class="para">Why then <code class="code step">p:load</code>? Its main raison d’être is probably as left-over from the XProc&nbsp;1.0 days. Using a <code class="code step">p:load</code> in XProc&nbsp;1.0 was
      the only way to dynamically load a document, for instance when you had computed its filename. In recent versions, using AVTs, this is no longer
      a problem: <code class="tag">&lt;p:with-input href="{$filename}"/&gt;</code>. </p><p class="para">The main reason for using <code class="code step">p:load</code> probably comes from software engineering: it makes it very explicit in your code what you’re doing,
      an explicit <code class="code step">p:load</code> stands out more than a nested <code class="tag">&lt;p:document&gt;</code>. Whether this is reason enough is up to you.</p><div class="sect3" id="determining-content-type"><a name="determining-content-type"><!----></a><h3 class="sect3">Determining the content-type</h3><p class="para">When a document is loaded, <code class="code step">p:load</code> must know its content-type. This is determined as follows:</p><ul class="itemizedlist"><li><p class="para">When a <code class="code option">content-type</code> option is specified, this is used.</p></li><li><p class="para">If a protocol is used that specifies/returns a content-type, this is used. This is for instance the case when loading documents over
            HTTP(S).</p></li><li><p class="para">If no explicit type information was found, determining the content-type is implementation-defined and therefore dependent on the XProc
            processor used.</p><p class="para">When loading a document from disk (using the <code class="code">file://</code> protocol), in most cases, the XProc processor determines the
            content-type based on the filename extension. So a <code class="code">.xml</code> file will become XML, <code class="code">.txt</code> text, etc. What extensions
            are mapped to what content-type is, again, implementation-defined. However, you can be reasonably sure the most common extensions are
            interpreted correctly.</p></li></ul></div></div><div class="sect2" id="sect2-d645e61337"><a name="sect2-d645e61337"><!----></a><h2 class="sect2">Examples</h2><div class="sect3" id="sect3-d645e61340"><a name="sect3-d645e61340"><!----></a><h3 class="sect3">Basic usage</h3><p class="para">Assume there is an XML document (in the same location as the pipeline) called <code class="code">extra.xml</code> with the following contents:</p><div class="programlisting"><pre class="programlisting">&lt;extras&gt;
  &lt;extra&gt;This is nice!&lt;/extra&gt;
&lt;/extras&gt;</pre></div><p class="para">The most simple pipeline that uses <code class="code step">p:load</code> to load this document is:</p><div class="programlisting"><pre class="programlisting">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt;

  &lt;p:output port="result"/&gt;

  &lt;p:load href="extra.xml"/&gt;

&lt;/p:declare-step&gt;</pre></div><p class="para keep-with-next">Result document:</p><div class="programlisting"><pre class="programlisting">&lt;extras&gt;
   &lt;extra&gt;This is nice!&lt;/extra&gt;
&lt;/extras&gt;</pre></div></div></div><div class="sect2" id="sect2-d645e61359"><a name="sect2-d645e61359"><!----></a><h2 class="sect2">Additional details</h2><ul class="itemizedlist"><li><p class="para">With regard to the document-properties of the loaded document:</p><ul class="itemizedlist"><li><p class="para">The <code class="code property">content-type</code> document-property is the content-type of the loaded document. See also <a href="#determining-content-type" class="xref">Determining the content-type</a>.</p></li><li><p class="para">The <code class="code property">base-uri</code> document-property is, in most cases, the URI the document is loaded from, as indicated by the
            <code class="code option">href</code> option.</p><p class="para">However, the <code class="code option">document-properties</code> option might also contain a <code class="code">base-uri</code> entry. If so, the value in the
            <code class="code option">document-properties</code> option is used.</p></li></ul></li><li><p class="para">A content-type can be specified using the <code class="code option">content-type</code> option and as en entry in the <code class="code option">document-properties</code>
      option map. If both are present they must be the same. If not, error <code class="code"><a href="#error-XD0062"><span class="link">XD0062</span></a></code> is raised.</p></li></ul></div><div class="sect2" id="sect2-d645e61414"><a name="sect2-d645e61414"><!----></a><h2 class="sect2">Errors raised</h2><div class="table nonumber error-codes-table"><table class="table nonumber error-codes-table"><thead><tr><th><p class="para">Error code</p></th><th><p class="para">Description</p></th></tr></thead><tbody><tr><td><p class="para" id="error-XD0011"><a name="error-XD0011"><!----></a><a href="../error-codes.html#error-XD0011"><span class="link"><code class="code">XD0011</code></span></a></p></td><td><p class="para">It is a dynamic error if the resource referenced by the <code class="code option">href</code> option does not exist, cannot be accessed or is not a
        file.</p></td></tr><tr><td><p class="para" id="error-XD0023"><a name="error-XD0023"><!----></a><a href="../error-codes.html#error-XD0023"><span class="link"><code class="code">XD0023</code></span></a></p></td><td><p class="para">It is a dynamic error if a DTD validation is performed and either the document is not valid or no DTD is found.</p></td></tr><tr><td><p class="para" id="error-XD0043"><a name="error-XD0043"><!----></a><a href="../error-codes.html#error-XD0043"><span class="link"><code class="code">XD0043</code></span></a></p></td><td><p class="para">It is a dynamic error if the <code class="code option">dtd-validate</code> parameter is <code class="literal">true</code> and the processor does not support DTD
        validation.</p></td></tr><tr><td><p class="para" id="error-XD0049"><a name="error-XD0049"><!----></a><a href="../error-codes.html#error-XD0049"><span class="link"><code class="code">XD0049</code></span></a></p></td><td><p class="para">It is a dynamic error if the text value is not a well-formed XML document</p></td></tr><tr><td><p class="para" id="error-XD0057"><a name="error-XD0057"><!----></a><a href="../error-codes.html#error-XD0057"><span class="link"><code class="code">XD0057</code></span></a></p></td><td><p class="para">It is a dynamic error if the text document does not conform to the JSON grammar, unless the parameter liberal is true and the processor
        chooses to accept the deviation.</p></td></tr><tr><td><p class="para" id="error-XD0058"><a name="error-XD0058"><!----></a><a href="../error-codes.html#error-XD0058"><span class="link"><code class="code">XD0058</code></span></a></p></td><td><p class="para">It is a dynamic error if the parameter duplicates is reject and the text document contains a JSON object with duplicate keys.</p></td></tr><tr><td><p class="para" id="error-XD0059"><a name="error-XD0059"><!----></a><a href="../error-codes.html#error-XD0059"><span class="link"><code class="code">XD0059</code></span></a></p></td><td><p class="para">It is a dynamic error if the parameter map contains an entry whose key is defined in the specification of
          <code class="function">fn:parse-json</code> and whose value is not valid for that key, or if it contains an entry with the key fallback when the
        parameter <code class="literal">escape</code> with <code class="literal">true()</code> is also present.</p></td></tr><tr><td><p class="para" id="error-XD0060"><a name="error-XD0060"><!----></a><a href="../error-codes.html#error-XD0060"><span class="link"><code class="code">XD0060</code></span></a></p></td><td><p class="para">It is a dynamic error if the text document can not be converted into the XPath data model</p></td></tr><tr><td><p class="para" id="error-XD0062"><a name="error-XD0062"><!----></a><a href="../error-codes.html#error-XD0062"><span class="link"><code class="code">XD0062</code></span></a></p></td><td><p class="para">It is a dynamic error if the <code class="tag">@content-type</code> is specified and the document-properties has a
          “<code class="code">content-type</code>” that is not the same.</p></td></tr><tr><td><p class="para" id="error-XD0064"><a name="error-XD0064"><!----></a><a href="../error-codes.html#error-XD0064"><span class="link"><code class="code">XD0064</code></span></a></p></td><td><p class="para">It is a dynamic error if the base URI is not both absolute and valid according to <a href="https://www.rfc-editor.org/info/rfc3986" target="_blank"><span class="link newpage">RFC&nbsp;3986</span></a> .</p></td></tr><tr><td><p class="para" id="error-XD0078"><a name="error-XD0078"><!----></a><a href="../error-codes.html#error-XD0078"><span class="link"><code class="code">XD0078</code></span></a></p></td><td><p class="para">It is a dynamic error if the loaded document cannot be represented as an HTML document in the XPath data model.</p></td></tr><tr><td><p class="para" id="error-XD0079"><a name="error-XD0079"><!----></a><a href="../error-codes.html#error-XD0079"><span class="link"><code class="code">XD0079</code></span></a></p></td><td><p class="para">It is a dynamic error if a supplied content-type is not a valid media type of the form “<code class="literal"><code class="replaceable italic">type</code>/<code class="replaceable italic">subtype</code>+<code class="replaceable italic">ext</code></code>” or “<code class="literal"><code class="replaceable italic">type</code>/<code class="replaceable italic">subtype</code></code>”.</p></td></tr></tbody></table></div></div><div class="sect2" id="sect2-d645e61586"><a name="sect2-d645e61586"><!----></a><h2 class="sect2">Reference information</h2><p class="para">This description of the <code class="code step">p:load</code> step is for XProc version: <a href="index.html"><span class="link">3.0</span></a>. This is a required step (an XProc 3.0 processor must support this).</p><p class="para">The formal specification for the <code class="code step">p:load</code> step can be found <a href="https://spec.xproc.org/3.0/steps/#c.load" target="_blank"><span class="link newpage">here</span></a>.</p><p class="para">The <code class="code step">p:load</code> step is part of categories:</p><ul class="itemizedlist"><li><p class="para"><a href="Standard_XProc_steps.html"><span class="link">Standard XProc steps</span></a></p></li><li><p class="para"><a href="Interaction_with_the_environment.html"><span class="link">Interaction with the environment</span></a></p></li></ul><p class="para">The <code class="code step">p:load</code> step is also present in version:
                <a href="../3.1/p.load.html"><span class="link">3.1</span></a>.</p></div></div></div><p>&nbsp;</p></body></html>