<?xml version="1.0" encoding="UTF-8"?>
<step name="set-attributes"
      version-idref="v30"
      category-idrefs="standard-steps"
      short-description="[EDIT] set-attributes short description"
      required="true"
      publish="false"
      xsi:schemaLocation="http://www.xtpxlib.nl/ns/xprocref ../../../xsd/xprocref.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns="http://www.xtpxlib.nl/ns/xprocref">
   <specification-link href="{$BASELINK-STANDARD-STEPS}#c.set-attributes"/>
   <signature>
      <input port="source"
             primary="true"
             content-types="xml html"
             sequence="true">
         <description>
            <para>[EDIT] input source</para>
         </description>
      </input>
      <output port="result"
              content-types="xml html"
              primary="true"
              sequence="true">
         <description>
            <para>[EDIT] output result</para>
         </description>
      </output>
      <option name="match"
              as="xs:string"
              select="'/*'"
              subtype="XSLTSelectionPattern"
              required="false">
         <description>
            <para>[EDIT] option match</para>
         </description>
      </option>
      <option name="attributes"
              required="true"
              as="map(xs:QName, xs:anyAtomicType)">
         <description>
            <para>[EDIT] option attributes</para>
         </description>
      </option>
   </signature>
   <summary>
      <para>[EDIT]</para>
      <para>The <tag>p:set-attributes</tag> step sets attributes on matching elements.</para>
   </summary>
   <description>
      <para>[EDIT]</para>
      <para>The value of the <option>match</option> option must be an XSLTSelectionPattern. <emphasis role="bold">[ERROR <step-error-ref code="C0023"/>]</emphasis>
      </para>
      <para>A new attribute is created for each entry in the map appearing on the <option>attributes</option> option. The attribute name is taken from the entry's key while the attribute value is taken from the string value of the entry's value.</para>
      <para>If an attribute with the same name as one of the attributes to be created already exists, the value specified on the <option>attributes</option> option is used. The result port of this step produces a copy of the <port>source</port> port's document with the matching elements' attributes modified.</para>
      <para>The matching elements are specified by the selection pattern in the <option>match</option> option. All matching elements are processed. If no elements match, the step will not change any elements.</para>
      <para>If the attributes taken from the <option>attributes</option> use namespaces, prefixes, or prefixes bound to different namespaces, the document produced on the <port>result</port> output port will require namespace fixup.</para>
      <para>If an attribute named <tag class="attribute">xml:base</tag> is added or changed, the base URI of the element must also be amended accordingly.</para>
      <bridgehead>Document properties</bridgehead>
      <para feature="set-attributes-preserves-all">All document properties are preserved.</para>
   </description>
   <step-errors>
      <step-error code="C0023">
         <description>
            <para>It is a dynamic error if that pattern matches anything other than element nodes.</para>
         </description>
      </step-error>
   </step-errors>
</step>