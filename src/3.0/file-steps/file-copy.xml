<?xml version="1.0" encoding="UTF-8"?>
<step name="file-copy" version-idref="v30" category-idrefs="file-steps" short-description="[EDIT] file-copy short description" required="false"
  publish="false" href-specification="{$BASELINK-FILE-STEPS-V30}#c.file-copy"
  xsi:schemaLocation="http://www.xtpxlib.nl/ns/xprocref ../../../xsd/xprocref.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns="http://www.xtpxlib.nl/ns/xprocref">
  <signature>
    <output port="result" primary="true" content-types="application/xml" sequence="false">
      <description>
        <para>[EDIT] output result</para>
      </description>
    </output>
    <option name="href" required="true" as="xs:anyURI">
      <description>
        <para>[EDIT] option href</para>
      </description>
    </option>
    <option name="target" required="true" as="xs:anyURI">
      <description>
        <para>[EDIT] option target</para>
      </description>
    </option>
    <option name="fail-on-error" as="xs:boolean" select="true()" required="false">
      <description>
        <para>[EDIT] option fail-on-error</para>
      </description>
    </option>
    <option name="overwrite" as="xs:boolean" select="true()" required="false">
      <description>
        <para>[EDIT] option overwrite</para>
      </description>
    </option>
  </signature>
  <summary>
    <para>[EDIT]</para>
    <para>The <code>p:file-copy</code> step copies a file or a directory to a given target.</para>
  </summary>
  <description>
    <para>[EDIT]</para>
    <para>The <tag>p:file-copy</tag> step copies the file or directory named in <option>href</option> to the new position specified in
        <option>target</option>. Any non existent directory contained in <option>target</option> will be created before copying starts. If the target
      is a directory, the step attempts to copy the file or directory into that directory, preserving its base name. <emphasis role="bold">[ERROR
          <step-error-ref code="XC0157"/>]</emphasis></para>
    <para>If the <option>overwrite</option> evaluates to <literal>false</literal>, no existing file will be changed.</para>
    <para>Conformant processors must support URIs whose scheme is <code>file</code> for the <option>href</option> and <option>target</option> options
      of <tag>p:file-copy</tag>. It is implementation-defined what other schemes are supported by <tag>p:file-copy</tag>, and what the interpretation
      of ‘directory’, ‘file’ and ‘contents’ is for those schemes. <emphasis role="bold">[ERROR <step-error-ref code="XC0144"/>]</emphasis>
    </para>
    <para>If <option>href</option> or <option>target</option> are relative, they are made absolute against the base URI of the element on which they
      are specified (<tag>p:with-option</tag> or <tag>p:file-copy</tag> in the case of a syntactic shortcut value). <emphasis role="bold">[ERROR
          <step-error-ref code="XD0064"/>]</emphasis>
      <emphasis role="bold">[ERROR <step-error-ref code="XC0145"/>]</emphasis></para>
    <para>If no error occurs, the step returns a <tag>c:result</tag> element containing the absolute URI of the target.</para>
    <para>If an error occurs and <option>fail-on-error</option> is <code>false</code>, the step returns a <tag>c:error</tag> element which may contain
      additional, implementation-defined, information about the nature of the error. In the case of a recursive copy, processing stops at the first
      error.</para>
    <para>If an error occurs and <option>fail-on-error</option> is <code>true</code>, one of the following errors is raised:</para>
    <itemizedlist>
      <listitem>
        <para>
          <emphasis role="bold">[ERROR <step-error-ref code="XD0011"/>]</emphasis>
        </para>
      </listitem>
      <listitem>
        <para>
          <emphasis role="bold">[ERROR <step-error-ref code="XC0050"/>]</emphasis>
        </para>
      </listitem>
    </itemizedlist>
    <bridgehead>Copying directories</bridgehead>
    <para>If <option>href</option> identifies a directory and <code>target</code> also identifies a directory, or does not exist, then the
        <tag>p:file-copy</tag> step attempts to copy the entire directory tree identified by <option>href</option>: the directory and all of its
      descendants.</para>
    <para>In this case:</para>
    <itemizedlist>
      <listitem>
        <para>If <option>fail-on-error</option> is <code>false</code> and an error occurs, no further copying is attempted after the first error is
          detected.</para>
      </listitem>
      <listitem>
        <para>If <option>overwrite</option> is <code>true</code>, <code>err:XC0157</code> does not apply to descendants. A directory under
            <option>href</option> may replace a file with the corresponding name under <option>target</option>. </para>
      </listitem>
    </itemizedlist>
    <bridgehead>Document properties</bridgehead>
    <para feature="file-copy-preserves-none">The resulting document has no properties apart from <property>content-type</property>. In particular, it
      has no <property>base-uri</property>.</para>
  </description>
  <step-errors>
    <step-error code="XC0157"/>
    <step-error code="XC0144"/>
    <step-error code="XD0064"/>
    <step-error code="XC0145"/>
    <step-error code="XD0011"/>
    <step-error code="XC0050"/>
  </step-errors>
</step>
